# looselips -- find personal information you accidentally shared with LLMs
#
# Usage: looselips chatgpt-export.zip --config looselips.toml

# ---------------------------------------------------------------------------
# Default model for LLM matchers (any LiteLLM model string)
# ---------------------------------------------------------------------------

# model = "ollama/qwen3:0.6b"

# ===========================================================================
# REGEX MATCHERS
# ===========================================================================
# Each regex matcher needs: type, category, pattern.
# Optional: ignore_case (default false).
# Patterns use Python regex syntax.

# --- Identity & Government IDs -------------------------------------------

[[matcher]]
type = "regex"
category = "Social Security Number"
# Matches SSN formats: 123-45-6789, 123 45 6789, 123456789
# The first group cannot be 000, 666, or 900-999 per SSA rules.
pattern = '\b(?!000|666|9\d\d)\d{3}[- ]?\d{2}[- ]?\d{4}\b'

[[matcher]]
type = "regex"
category = "US ITIN"
# Individual Taxpayer Identification Number -- always starts with 9,
# with specific ranges for the middle group.
pattern = '\b9\d{2}[- ](5\d|6[0-5]|7\d|8[0-8]|9([0-2]|[4-9]))[- ]\d{4}\b'

# --- Financial ------------------------------------------------------------

[[matcher]]
type = "regex"
category = "Credit Card Number"
# Visa, Mastercard, Amex, Discover -- with optional spaces or dashes.
pattern = '\b(?:4\d{3}|5[1-5]\d{2}|3[47]\d{2}|6(?:011|5\d{2}))[- ]?\d{4}[- ]?\d{4}[- ]?\d{2,4}\b'

[[matcher]]
type = "regex"
category = "IBAN"
# International Bank Account Number -- 2-letter country code + 2 check
# digits + up to 30 alphanumeric characters.
pattern = '(?<![A-Z0-9])[A-Z]{2}\d{2}[- ]?[A-Z0-9]{4}([- ]?[A-Z0-9]{4}){1,7}[- ]?[A-Z0-9]{1,4}(?![A-Z0-9])'

[[matcher]]
type = "regex"
category = "Cryptocurrency Address"
# Bitcoin addresses (P2PKH, P2SH, Bech32).
pattern = '\b(bc1|[13])[a-zA-HJ-NP-Z0-9]{25,59}\b'

# --- Contact Information --------------------------------------------------

[[matcher]]
type = "regex"
category = "Email Address"
pattern = '\b[A-Za-z0-9._%+\-]+@[A-Za-z0-9.\-]+\.[A-Za-z]{2,}\b'

[[matcher]]
type = "regex"
category = "Phone Number (US)"
# US phone numbers: (555) 123-4567, 555-123-4567, +1 555 123 4567, etc.
pattern = '(?:\+?1[- .])?\(?\d{3}\)?[- .]\d{3}[- .]\d{4}\b'

# --- Credentials & Secrets ------------------------------------------------

[[matcher]]
type = "regex"
category = "AWS Access Key"
# AWS access key IDs always start with AKIA and are 20 chars.
pattern = '\bAKIA[0-9A-Z]{16}\b'

[[matcher]]
type = "regex"
category = "AWS Secret Key"
# AWS secret keys are 40 base-64 characters.
pattern = '\b[A-Za-z0-9/+=]{40}\b'

[[matcher]]
type = "regex"
category = "Generic API Key"
# Catches lines like: api_key = "sk-abc123...", "Authorization: Bearer ..."
pattern = """(?i)(?:api[_-]?key|api[_-]?secret|access[_-]?token|auth[_-]?token|bearer)\s*[:=]\s*["']?[A-Za-z0-9_\-]{20,}["']?"""
ignore_case = true

[[matcher]]
type = "regex"
category = "Password in Text"
# Catches "my password is ...", "password: ...", "passwd = ...", etc.
pattern = '(?i)(?:password|passwd|pwd)\s*(?:is|was|=|:)\s*\S+'
ignore_case = true

[[matcher]]
type = "regex"
category = "Private Key Block"
# PEM-encoded private keys (RSA, EC, generic).
pattern = '-----BEGIN (?:RSA |EC )?PRIVATE KEY-----'

[[matcher]]
type = "regex"
category = "Database Connection String"
# Connection URLs with embedded credentials: postgres://user:pass@host
pattern = '(?:postgres(?:ql)?|mysql|mongodb(?:\+srv)?|redis|amqp)://[^\s]+'

# --- Physical Location ----------------------------------------------------

[[matcher]]
type = "regex"
category = "US Street Address"
# Common US street address patterns: 123 Main St, 4567 Oak Avenue, etc.
pattern = '\b\d{1,6}\s+(?:[NSEW]\.?\s+)?[A-Z][a-zA-Z]+(?:\s+[A-Z][a-zA-Z]+)*\s+(?:St|Street|Ave|Avenue|Blvd|Boulevard|Dr|Drive|Ln|Lane|Rd|Road|Ct|Court|Way|Pl|Place|Cir|Circle)\.?\b'

[[matcher]]
type = "regex"
category = "US Zip Code (with context)"
# Five-digit zip or zip+4 when preceded by a state abbreviation.
pattern = '\b[A-Z]{2}\s+\d{5}(?:-\d{4})?\b'

# ===========================================================================
# LLM MATCHERS
# ===========================================================================
# LLM matchers use a local model to detect things regex cannot.
# Each one runs a separate inference pass per conversation chunk, so prefer
# a few focused matchers over many broad ones.
#
# Requires the 'model' setting above (or a per-matcher 'model' override).

# [[matcher]]
# type = "llm"
# name = "Sensitive Content"
# prompt = """Flag anything that would be damaging if leaked.
#
# Look for: confessions of illegal activity, embarrassing personal
# details, evidence of substance abuse, sexual content, information
# the user explicitly asked to keep private, or anything the user
# would not want an employer, family member, or journalist to see."""
