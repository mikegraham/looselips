# looselips sample config -- sensitive PII and secrets
#
# Usage: looselips chatgpt-export.zip --config sample_config.toml
#
# Each regex matcher needs: type ("regex"), category, pattern.
# Patterns use Python re syntax -- inline flags like (?i) for case-insensitive,
# (?s) for dotall, and (?x) for verbose mode (comments + ignored whitespace)
# are supported.

# Default model for LLM matchers (any LiteLLM model string). Required to have llm matchers below.
model = "ollama/qwen3:0.6b"

[[matcher]]
type = "regex"
category = "SSN (or IRS ITIN)"
# US Government IDs
# SSN (excluding invalid prefixes 000, 666, 9xx) and IRS ITIN (9xx with
# IRS-specified middle groups). Formats: 123-45-6789, 123 45 6789, 123456789.
pattern = '''\b(?:(?!000|666|9\d\d)\d{3}|9\d{2})[- ]?\d{2}[- ]?\d{4}\b'''

[[matcher]]
type = "regex"
category = "Credit Card Number"
# Visa, Mastercard, Amex, Discover -- with optional spaces or dashes.
pattern = '\b(?:4\d{3}|5[1-5]\d{2}|3[47]\d{2}|6(?:011|5\d{2}))[- ]?\d{4}[- ]?\d{4}[- ]?\d{2,4}\b'

[[matcher]]
type = "regex"
category = "Credential / Secret"
pattern = '''(?xi)
  # API keys with keyword labels (api_key = "...", Bearer ...)
  (?:api[_-]?key|api[_-]?secret|access[_-]?token|auth[_-]?token|bearer)
  \s*[:=]\s*["']?[A-Za-z0-9_\-]{20,}["']?
  # AWS access key IDs (AKIA prefix, 20 chars)
  | \bAKIA[0-9A-Z]{16}\b
  # PEM private key blocks
  | -----BEGIN\ (?:RSA\ |EC\ )?PRIVATE\ KEY-----
  # Database connection URLs with embedded credentials
  | (?:postgres(?:ql)?|mysql|mongodb(?:\+srv)?|redis|amqp)://[^\s]+
'''

[[matcher]]
type = "llm"
name = "Compromising Content"
prompt = """Flag content the user would not want leaked to an employer,
family member, or journalist.

Look for: confessions or descriptions of illegal activity, evidence of
drug use or substance abuse, sexual content or explicit material,
passwords or credentials spoken in plain language, detailed financial
account information, or anything the user explicitly said should be
kept secret or private."""
